<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link type="image/x-icon" rel="icon" href="https://makers.tech/wp-content/themes/wp-makers-2018/favicon.ico">
    <title>News Summary Challenge</title>
    <link rel="canonical" href="https://github.com/Tolvic/news-summary-challenge" />
    <style>

    </style>

  </head>
  <body>
    <nav>
      News Summary Challenge
    </nav>

    <div class="main-content">
      <section id="headlines">
        <article class="">
          <a href="#"><img src="http://www.thebusinessclinic.org/images/news.jpg" alt=""></a>
          <a href="#"><h2>Article headline</h2></a>
          <details>
            <summary>View summary</summary>
              <p>Article summary line 1.</p>
              <p>Article summary line 2.</p>
          </details>
        </article>

      </section>

      <section id="chosen-article">
        <article class="">
          <header>
            <h1>Article headline</h1>
            <p>byline</p>
          </header>

          <p>article text</p>
        </article>

      </section>

    </div>

    <footer>Created by <a href="https://github.com/Tolvic/">Terry Mace</a></footer>

    <script type="text/javascript">
      var guardianData;
      window.onload = function() {
        guardianAPICall();
      };

      function generateHeadlines(){
        for (var i = 0; i < window.guardianData.response.results.length; i++) {
          //contents variables
          var data = guardianData.response.results[i]
          var headline = document.createTextNode(data.webTitle);
          var bylineText = document.createTextNode(data.fields.trailText);
          var image = data.fields.thumbnail;
          console.log("headline: " + headline);
          console.log("byline: " + byline);
          console.log("image: " + image);

          //create html elements
          var article = document.createElement('article');
          var link = document.createElement('a');
          link.href="#";
          var link2 = document.createElement('a');
          link2.href="#";
          var header = document.createElement('h2');
          var imageElement = document.createElement('img');
          imageElement.src = image;
          var details = document.createElement('details');
          var summary = document.createElement('summary');
          var byline = document.createElement('p');

          // Append elements
          byline.appendChild(bylineText);
          summary.appendChild(byline);
          details.appendChild(summary);

          header.appendChild(headline);
          link.appendChild(header);

          link2.appendChild(imageElement)

          article.appendChild(link2)
          article.appendChild(link)
          article.appendChild(details)

          console.log(article);
        }
      }


      function guardianAPICall(){
        // Create a request variable and assign a new XMLHttpRequest object to it.
        var request = new XMLHttpRequest();


        // Open a new connection, using the GET request on the URL endpoint
        request.open('GET', 'http://news-summary-api.herokuapp.com/guardian?apiRequestUrl=http://content.guardianapis.com/search?show-fields=headline,trailText,thumbnail', true);

        //set what should happen when request is sent
        request.onload = function () {

          if (this.readyState == 4 && this.status == 200) {
            guardianData = JSON.parse(this.response);
            console.log(guardianData);
            generateHeadlines();
          }

        }
        // Send request
        request.send();
      }
    </script>

  </body>
</html>
